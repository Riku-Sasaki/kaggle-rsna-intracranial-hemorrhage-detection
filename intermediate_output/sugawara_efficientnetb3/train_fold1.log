
----- 2019-11-24 03:27:20 -----
/root/user/project/submit_dir/kaggle-rsna-intracranial-hemorrhage-detection/models/base_cnn/sugawara_efficientnetb3/src/cnn/main.py train ./conf/sugawara_efficientnetb3.py --fold 1 --gpu 0
logpath: ../../../intermediate_output/sugawara_efficientnetb3/train_fold1.log
mode: train
workdir: ../../../intermediate_output/sugawara_efficientnetb3
fold: 1
batch size: 28
acc: 1
model: efficientnet-b3
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
dataset_policy: all
window_policy: 2
read dataset (819 records)
applied dataset_policy all (819 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (204 records)
applied dataset_policy all (204 records)
use default(random) sampler
train data: loaded 819 records
valid data: loaded 204 records
last_epoch: -1
apex True

----- epoch 0 -----
[train] 29/29 23(s) eta:0(s) loss:0.681297 loss200:0.681297 lr:6.00e-05 auc:0.5703 micro:0.5961 macro:0.5446
0.583955 [0.595179 0.550038 0.560957 0.601505 0.56458  0.620246]
[valid] 8/8 4(s) eta:0(s) loss:0.691993 loss200:0.691993 lr:0.00e+00 auc:0.4887 micro:0.5181 macro:0.4592
0.589624 [0.629797 0.529445 0.592559 0.572187 0.522673 0.650908]
saved model to ../../../intermediate_output/sugawara_efficientnetb3/fold1_ep0.pt
[best] ep:0 loss:0.6920 score:0.5896

----- epoch 1 -----
[train] 29/29 16(s) eta:0(s) loss:0.452993 loss200:0.452993 lr:4.00e-05 auc:0.5982 micro:0.6162 macro:0.5801
0.388274 [0.398427 0.348084 0.35228  0.408718 0.355904 0.456078]
[valid] 8/8 2(s) eta:0(s) loss:0.515075 loss200:0.515075 lr:0.00e+00 auc:0.4994 micro:0.5240 macro:0.4749
0.437308 [0.47547  0.341417 0.451756 0.459615 0.36434  0.493087]
saved model to ../../../intermediate_output/sugawara_efficientnetb3/fold1_ep1.pt
[best] ep:1 loss:0.5151 score:0.4373

----- epoch 2 -----
[train] 29/29 16(s) eta:0(s) loss:0.345487 loss200:0.345487 lr:2.67e-05 auc:0.7337 micro:0.7497 macro:0.7176
0.296133 [0.325277 0.245597 0.257103 0.304308 0.251993 0.363374]
[valid] 8/8 2(s) eta:0(s) loss:0.426415 loss200:0.426415 lr:0.00e+00 auc:0.6580 micro:0.6711 macro:0.6449
0.360820 [0.408512 0.25317  0.368793 0.391166 0.291552 0.404034]
saved model to ../../../intermediate_output/sugawara_efficientnetb3/fold1_ep2.pt
[best] ep:2 loss:0.4264 score:0.3608
