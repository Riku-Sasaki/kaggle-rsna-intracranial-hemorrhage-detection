
----- 2019-11-23 12:08:32 -----
/root/user/project/kaggle-rsna-intracranial-hemorrhage-detection/models/base_cnn/model_2/src/cnn/main.py train ./conf/model.py --fold 0 --gpu 0
logpath: ../../../intermediate_output/model_2/train_fold0.log
mode: train
workdir: ../../../intermediate_output/model_2
fold: 0
batch size: 28
acc: 1
model: se_resnext101_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
dataset_policy: all
window_policy: 2
read dataset (851 records)
applied dataset_policy all (851 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (172 records)
applied dataset_policy all (172 records)
use default(random) sampler
train data: loaded 851 records
valid data: loaded 172 records
last_epoch: -1
apex True

----- epoch 0 -----
[train] 30/30 48(s) eta:0(s) loss:0.383464 loss200:0.383464 lr:6.00e-05 auc:0.5124 micro:0.5286 macro:0.4961
0.333409 [0.387238 0.2641   0.278292 0.35576  0.28334  0.377891]
[valid] 7/7 6(s) eta:0(s) loss:0.387798 loss200:0.387798 lr:0.00e+00 auc:0.5360 micro:0.5676 macro:0.5043
0.290157 [0.45243  0.137554 0.375971 0.161869 0.140366 0.310477]
saved model to ../../../intermediate_output/model_2/fold0_ep0.pt
[best] ep:0 loss:0.3878 score:0.2902

----- epoch 1 -----
[train] 30/30 39(s) eta:0(s) loss:0.193295 loss200:0.193295 lr:4.00e-05 auc:0.7863 micro:0.8042 macro:0.7684
0.180415 [0.246768 0.101921 0.143097 0.187467 0.123848 0.213038]
[valid] 7/7 3(s) eta:0(s) loss:0.326138 loss200:0.326138 lr:0.00e+00 auc:0.5832 micro:0.6081 macro:0.5584
0.235835 [0.364789 0.122554 0.311856 0.142546 0.124664 0.219647]
saved model to ../../../intermediate_output/model_2/fold0_ep1.pt
[best] ep:1 loss:0.3261 score:0.2358

----- epoch 2 -----

----- 2019-11-23 12:16:21 -----
/root/user/project/kaggle-rsna-intracranial-hemorrhage-detection/models/base_cnn/model_2/src/cnn/main.py train ./conf/model.py --fold 0 --gpu 0
logpath: ../../../intermediate_output/model_2/train_fold0.log
mode: train
workdir: ../../../intermediate_output/model_2
fold: 0
batch size: 28
acc: 1
model: se_resnext101_32x4d
pretrained: imagenet
loss: BCEWithLogitsLoss
optim: Adam
dataset_policy: all
window_policy: 2
read dataset (851 records)
applied dataset_policy all (851 records)
use default(random) sampler
dataset_policy: all
window_policy: 2
read dataset (172 records)
applied dataset_policy all (172 records)
use default(random) sampler
train data: loaded 851 records
valid data: loaded 172 records
last_epoch: -1
apex True

----- epoch 0 -----
[train] 30/30 50(s) eta:0(s) loss:0.383464 loss200:0.383464 lr:6.00e-05 auc:0.5124 micro:0.5286 macro:0.4961
0.333409 [0.387238 0.2641   0.278292 0.35576  0.28334  0.377891]
[valid] 7/7 7(s) eta:0(s) loss:0.387798 loss200:0.387798 lr:0.00e+00 auc:0.5360 micro:0.5676 macro:0.5043
0.290157 [0.45243  0.137554 0.375971 0.161869 0.140366 0.310477]
saved model to ../../../intermediate_output/model_2/fold0_ep0.pt
[best] ep:0 loss:0.3878 score:0.2902

----- epoch 1 -----
[train] 30/30 38(s) eta:0(s) loss:0.193295 loss200:0.193295 lr:4.00e-05 auc:0.7863 micro:0.8042 macro:0.7684
0.180415 [0.246768 0.101921 0.143097 0.187467 0.123848 0.213038]
[valid] 7/7 3(s) eta:0(s) loss:0.326138 loss200:0.326138 lr:0.00e+00 auc:0.5832 micro:0.6081 macro:0.5584
0.235835 [0.364789 0.122554 0.311856 0.142546 0.124664 0.219647]
saved model to ../../../intermediate_output/model_2/fold0_ep1.pt
[best] ep:1 loss:0.3261 score:0.2358

----- epoch 2 -----
[train] 30/30 38(s) eta:0(s) loss:0.147079 loss200:0.147079 lr:2.67e-05 auc:0.9255 micro:0.9312 macro:0.9199
0.130407 [0.169994 0.07784  0.104983 0.137942 0.090503 0.161595]
[valid] 7/7 3(s) eta:0(s) loss:0.357089 loss200:0.357089 lr:0.00e+00 auc:0.5534 micro:0.5796 macro:0.5272
0.240331 [0.378019 0.12236  0.334346 0.144779 0.126151 0.198644]
saved model to ../../../intermediate_output/model_2/fold0_ep2.pt
[best] ep:1 loss:0.3261 score:0.2358
